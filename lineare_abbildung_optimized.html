<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Lineare Abbildung in ‚Ñù¬≤</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,600;0,9..144,700;1,9..144,300&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

<style>
:root {
  --bg-primary: #fefdf8;
  --bg-secondary: #f7f5ed;
  --fg-primary: #1a1614;
  --fg-secondary: #5a5450;
  --canvas-bg: #ffffff;
  --grid: #e8e4db;
  --accent-primary: #d97706;
  --accent-secondary: #059669;
  --accent-tertiary: #0891b2;
  --border: #d4cfc4;
  --shadow: rgba(26, 22, 20, 0.08);
  --glow: rgba(217, 119, 6, 0.15);
  --e1-color: #3b82f6;
  --e2-color: #10b981;
  --e1-bg: rgba(59, 130, 246, 0.1);
  --e2-bg: rgba(16, 185, 129, 0.1);
}

.dark {
  --bg-primary: #0f0e0d;
  --bg-secondary: #1a1816;
  --fg-primary: #faf8f3;
  --fg-secondary: #a39d95;
  --canvas-bg: #1a1816;
  --grid: #2d2a26;
  --accent-primary: #fb923c;
  --accent-secondary: #34d399;
  --accent-tertiary: #22d3ee;
  --border: #3d3934;
  --shadow: rgba(0, 0, 0, 0.3);
  --glow: rgba(251, 146, 60, 0.2);
  --e1-color: #60a5fa;
  --e2-color: #34d399;
  --e1-bg: rgba(96, 165, 250, 0.15);
  --e2-bg: rgba(52, 211, 153, 0.15);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: var(--bg-primary);
  color: var(--fg-primary);
  font-family: 'Fraunces', serif;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 2rem 1rem;
}

.container {
  max-width: 1200px;
  width: 100%;
}

header {
  text-align: center;
  margin-bottom: 2rem;
}

h1 {
  font-size: clamp(2rem, 5vw, 3.5rem);
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-bottom: 0.5rem;
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.subtitle {
  font-size: 1rem;
  color: var(--fg-secondary);
  font-weight: 300;
  font-style: italic;
}

.main-content {
  display: grid;
  gap: 2rem;
  grid-template-columns: 1fr;
}

@media (min-width: 1024px) {
  .main-content {
    grid-template-columns: 1fr 400px;
  }
}

.canvas-section {
  background: var(--bg-secondary);
  border-radius: 1rem;
  padding: 1.5rem;
  box-shadow: 0 4px 20px var(--shadow);
  border: 1px solid var(--border);
}

canvas {
  background: var(--canvas-bg);
  border-radius: 0.75rem;
  border: 2px solid var(--border);
  touch-action: none;
  width: 100%;
  height: auto;
  display: block;
  box-shadow: 0 8px 32px var(--shadow);
}

.control-panel {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.card {
  background: var(--bg-secondary);
  border-radius: 1rem;
  padding: 1.5rem;
  box-shadow: 0 4px 20px var(--shadow);
  border: 1px solid var(--border);
}

.card-title {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: var(--fg-primary);
  letter-spacing: -0.01em;
}

.matrix-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 2rem;
  color: var(--accent-primary);
  margin-bottom: 1rem;
}

.matrix {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.5rem;
}

.bracket {
  font-size: 4rem;
  font-weight: 300;
  color: var(--fg-secondary);
}

.matrix input {
  width: 70px;
  height: 50px;
  font-size: 1.25rem;
  font-family: 'IBM Plex Mono', monospace;
  text-align: center;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  background: var(--canvas-bg);
  color: var(--fg-primary);
  font-weight: 500;
}

.matrix input.e1-col {
  background: var(--e1-bg);
  border-color: var(--e1-color);
}

.matrix input.e2-col {
  background: var(--e2-bg);
  border-color: var(--e2-color);
}

.matrix input:focus {
  outline: none;
  box-shadow: 0 0 0 3px var(--glow);
}

.examples-section {
  margin-bottom: 1rem;
}

.examples-label {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
  color: var(--fg-secondary);
}

.examples-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.5rem;
}

.example-btn {
  padding: 0.5rem 0.75rem;
  font-size: 0.85rem;
  font-family: 'Fraunces', serif;
  font-weight: 600;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  background: var(--canvas-bg);
  color: var(--fg-primary);
  cursor: pointer;
  text-align: left;
  transition: all 0.2s ease;
}

.example-btn:hover {
  border-color: var(--accent-primary);
  background: var(--bg-primary);
}

.example-btn .example-name {
  display: block;
  font-weight: 700;
  margin-bottom: 0.15rem;
}

.example-btn .example-desc {
  display: block;
  font-size: 0.75rem;
  font-weight: 400;
  color: var(--fg-secondary);
}

.vector-input {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-family: 'IBM Plex Mono', monospace;
  flex-wrap: wrap;
  justify-content: center;
}

.vector-label {
  font-weight: 600;
  color: var(--fg-primary);
}

.vector-input input {
  width: 60px;
  height: 40px;
  font-size: 1rem;
  font-family: 'IBM Plex Mono', monospace;
  text-align: center;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  background: var(--canvas-bg);
  color: var(--fg-primary);
}

.vector-input input:focus {
  outline: none;
  border-color: var(--accent-tertiary);
  box-shadow: 0 0 0 3px rgba(8, 145, 178, 0.15);
}

.button-group {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 0.75rem;
}

button {
  padding: 0.75rem 1.25rem;
  font-size: 1rem;
  font-family: 'Fraunces', serif;
  font-weight: 600;
  border: 2px solid var(--border);
  border-radius: 0.5rem;
  background: var(--canvas-bg);
  color: var(--fg-primary);
  cursor: pointer;
}

button:hover {
  border-color: var(--accent-primary);
}

button:active {
  background: var(--bg-secondary);
}

.toggle-group {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.toggle-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  background: var(--canvas-bg);
  border: 1px solid var(--border);
}

.toggle-item input[type="checkbox"] {
  appearance: none;
  width: 20px;
  height: 20px;
  border: 2px solid var(--border);
  border-radius: 0.25rem;
  cursor: pointer;
  position: relative;
}

.toggle-item input[type="checkbox"]:checked {
  background: var(--accent-secondary);
  border-color: var(--accent-secondary);
}

.toggle-item input[type="checkbox"]:checked::after {
  content: '‚úì';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: white;
  font-size: 14px;
  font-weight: bold;
}

.toggle-item label {
  cursor: pointer;
  font-weight: 500;
  user-select: none;
}

.slider-container {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.slider-label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-family: 'IBM Plex Mono', monospace;
  font-size: 0.9rem;
  color: var(--fg-secondary);
}

input[type="range"] {
  width: 100%;
  height: 8px;
  border-radius: 4px;
  background: var(--border);
  outline: none;
  appearance: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--accent-primary);
  cursor: pointer;
  box-shadow: 0 2px 8px var(--shadow);
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--accent-primary);
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 8px var(--shadow);
}

.info-display {
  background: var(--canvas-bg);
  padding: 1rem;
  border-radius: 0.5rem;
  border: 1px solid var(--border);
  font-family: 'IBM Plex Mono', monospace;
  font-size: 1.1rem;
  text-align: center;
  color: var(--accent-tertiary);
  font-weight: 500;
  box-shadow: inset 0 2px 4px var(--shadow);
}

.legend {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  font-size: 0.9rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.legend-color {
  width: 24px;
  height: 24px;
  border-radius: 0.25rem;
  box-shadow: 0 2px 4px var(--shadow);
}

.legend-text {
  font-family: 'IBM Plex Mono', monospace;
  color: var(--fg-secondary);
}

@media (max-width: 1023px) {
  .control-panel {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 640px) {
  body {
    padding: 1rem 0.5rem;
  }
  
  .matrix-container {
    font-size: 1.5rem;
  }
  
  .bracket {
    font-size: 3rem;
  }
  
  .matrix input {
    width: 60px;
    height: 45px;
    font-size: 1.1rem;
  }
  
  .examples-grid {
    grid-template-columns: 1fr;
  }
}
</style>
</head>

<body>

<div class="container">
  <header>
    <h1>Lineare Abbildung in ‚Ñù¬≤</h1>
    <p class="subtitle">Interaktive Visualisierung von Matrixtransformationen</p>
  </header>

  <div class="main-content">
    <!-- Canvas Section -->
    <div class="canvas-section">
      <canvas id="canvas" width="800" height="800"></canvas>
    </div>

    <!-- Control Panel -->
    <div class="control-panel">
      
      <!-- Matrix Input Card -->
      <div class="card">
        <h2 class="card-title">Transformationsmatrix A</h2>
        
        <!-- Example matrices -->
        <div class="examples-section">
          <div class="examples-label">Beispiele:</div>
          <div class="examples-grid" id="examplesGrid"></div>
        </div>
        
        <div class="matrix-container">
          <div class="bracket">[</div>
          <div class="matrix">
            <input id="a11" value="1" type="number" step="0.1" class="e1-col">
            <input id="a12" value="0" type="number" step="0.1" class="e2-col">
            <input id="a21" value="0" type="number" step="0.1" class="e1-col">
            <input id="a22" value="1" type="number" step="0.1" class="e2-col">
          </div>
          <div class="bracket">]</div>
        </div>
        
        <div style="font-size: 0.85rem; color: var(--fg-secondary); text-align: center; margin-top: 0.5rem;">
          <span style="color: var(--e1-color);">‚óè</span> Spalte 1 ‚Üí e‚ÇÅ Transformation
          <span style="margin: 0 0.5rem;">|</span>
          <span style="color: var(--e2-color);">‚óè</span> Spalte 2 ‚Üí e‚ÇÇ Transformation
        </div>
      </div>

      <!-- Vector Input Card -->
      <div class="card">
        <h2 class="card-title">Testvektor</h2>
        <div class="vector-input">
          <span class="vector-label">v =</span>
          <span>(</span>
          <input id="vx" value="2" type="number" step="0.1">
          <span>,</span>
          <input id="vy" value="1" type="number" step="0.1">
          <span>)</span>
        </div>
      </div>

      <!-- Animation Controls Card -->
      <div class="card">
        <h2 class="card-title">Animation</h2>
        <div class="button-group">
          <button onclick="startAnimation()">‚ñ∂ Start</button>
          <button onclick="pause()">‚è∏ Pause</button>
          <button onclick="resetAll()">üîÑ Reset</button>
        </div>
        <div class="slider-container">
          <div class="slider-label">
            <span>Fortschritt</span>
            <span id="tValue">0%</span>
          </div>
          <input type="range" id="scrubber" min="0" max="100" value="0">
        </div>
      </div>

      <!-- Display Options Card -->
      <div class="card">
        <h2 class="card-title">Anzeigeoptionen</h2>
        <div class="toggle-group">
          <div class="toggle-item">
            <input type="checkbox" id="showAxes" checked>
            <label for="showAxes">Achsen</label>
          </div>
          <div class="toggle-item">
            <input type="checkbox" id="showTestVector">
            <label for="showTestVector">Testvektor</label>
          </div>
          <div class="toggle-item">
            <input type="checkbox" id="showDeterminant">
            <label for="showDeterminant">Determinante</label>
          </div>
          <div class="toggle-item">
            <input type="checkbox" id="darkToggle">
            <label for="darkToggle">Dark Mode</label>
          </div>
        </div>
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color" style="background: #3b82f6;"></div>
            <span class="legend-text">Basisvektor e‚ÇÅ</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #10b981;"></div>
            <span class="legend-text">Basisvektor e‚ÇÇ</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: #0891b2;"></div>
            <span class="legend-text">Testvektor v</span>
          </div>
        </div>
      </div>

      <!-- Result Display Card -->
      <div class="card">
        <h2 class="card-title">Informationen</h2>
        <div class="info-display" id="vectorInfo">A(v) = (0.00, 0.00)</div>
        <div class="info-display" id="detInfo" style="margin-top: 0.5rem;">det(A) = 0.00</div>
      </div>

    </div>
  </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const scale = 40;
const center = canvas.width / 2;
const gridSize = 10;

let t = 0;
let running = false;
let animationId = null;

// Example transformations
const examples = [
  {
    name: "Identit√§t",
    desc: "keine √Ñnderung",
    matrix: [[1, 0], [0, 1]]
  },
  {
    name: "Skalierung",
    desc: "2√ó Vergr√∂√üerung",
    matrix: [[2, 0], [0, 2]]
  },
  {
    name: "Streckung X",
    desc: "horizontal 2√ó",
    matrix: [[2, 0], [0, 1]]
  },
  {
    name: "Streckung Y",
    desc: "vertikal 2√ó",
    matrix: [[1, 0], [0, 2]]
  },
  {
    name: "Rotation 90¬∞",
    desc: "gegen Uhrzeiger",
    matrix: [[0, -1], [1, 0]]
  },
  {
    name: "Rotation 45¬∞",
    desc: "gegen Uhrzeiger",
    matrix: [[0.707, -0.707], [0.707, 0.707]]
  },
  {
    name: "Spiegelung X",
    desc: "an x-Achse",
    matrix: [[1, 0], [0, -1]]
  },
  {
    name: "Spiegelung Y",
    desc: "an y-Achse",
    matrix: [[-1, 0], [0, 1]]
  },
  {
    name: "Scherung X",
    desc: "horizontal kippen",
    matrix: [[1, 0.5], [0, 1]]
  },
  {
    name: "Scherung Y",
    desc: "vertikal kippen",
    matrix: [[1, 0], [0.5, 1]]
  },
  {
    name: "Projektion X",
    desc: "auf x-Achse",
    matrix: [[1, 0], [0, 0]]
  },
  {
    name: "Projektion Y",
    desc: "auf y-Achse",
    matrix: [[0, 0], [0, 1]]
  }
];

// Render example buttons
function renderExamples() {
  const grid = document.getElementById('examplesGrid');
  examples.forEach((ex, index) => {
    const btn = document.createElement('button');
    btn.className = 'example-btn';
    btn.innerHTML = `
      <span class="example-name">${ex.name}</span>
      <span class="example-desc">${ex.desc}</span>
    `;
    btn.onclick = () => loadExample(index);
    grid.appendChild(btn);
  });
}

function loadExample(index) {
  const ex = examples[index];
  a11.value = ex.matrix[0][0];
  a12.value = ex.matrix[0][1];
  a21.value = ex.matrix[1][0];
  a22.value = ex.matrix[1][1];
  
  // Reset animation
  t = 0;
  scrubber.value = 0;
  tValue.textContent = '0%';
  running = false;
  if(animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
  
  draw();
}

// Theme toggle
darkToggle.onchange = e => {
  document.body.classList.toggle("dark", e.target.checked);
};

// Scrubber
scrubber.oninput = e => {
  t = e.target.value / 100;
  tValue.textContent = Math.round(t * 100) + '%';
  draw();
};

// All inputs trigger redraw and reset animation
[a11, a12, a21, a22, vx, vy, showAxes, showTestVector, showDeterminant].forEach(el => {
  el.addEventListener('input', () => {
    // Reset animation when matrix changes
    if(el === a11 || el === a12 || el === a21 || el === a22) {
      t = 0;
      scrubber.value = 0;
      tValue.textContent = '0%';
      running = false;
      if(animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
      }
    }
    draw();
  });
  el.addEventListener('change', draw);
});

function transform(M, v) {
  return [
    M[0][0]*v[0] + M[0][1]*v[1],
    M[1][0]*v[0] + M[1][1]*v[1]
  ];
}

function arrow(x1, y1, x2, y2, color, width) {
  ctx.strokeStyle = color;
  ctx.fillStyle = color;
  ctx.lineWidth = width;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  ctx.lineTo(x2, y2);
  ctx.stroke();
  
  const angle = Math.atan2(y2-y1, x2-x1);
  const headLength = 15;
  
  ctx.beginPath();
  ctx.moveTo(x2, y2);
  ctx.lineTo(
    x2 - headLength * Math.cos(angle - Math.PI/6),
    y2 - headLength * Math.sin(angle - Math.PI/6)
  );
  ctx.lineTo(
    x2 - headLength * Math.cos(angle + Math.PI/6),
    y2 - headLength * Math.sin(angle + Math.PI/6)
  );
  ctx.closePath();
  ctx.fill();
}

function drawGrid(M) {
  const style = getComputedStyle(document.body);
  const gridColor = style.getPropertyValue('--grid').trim();
  
  ctx.strokeStyle = gridColor;
  ctx.lineWidth = 1;
  
  for(let i = -gridSize; i <= gridSize; i++) {
    drawLine(M, [i, -gridSize], [i, gridSize]);
    drawLine(M, [-gridSize, i], [gridSize, i]);
  }
}

function drawLine(M, p1, p2) {
  const a = transform(M, p1);
  const b = transform(M, p2);
  ctx.beginPath();
  ctx.moveTo(center + a[0]*scale, center - a[1]*scale);
  ctx.lineTo(center + b[0]*scale, center - b[1]*scale);
  ctx.stroke();
}

function drawAxes() {
  const style = getComputedStyle(document.body);
  const axisColor = style.getPropertyValue('--fg-secondary').trim();
  
  ctx.strokeStyle = axisColor;
  ctx.lineWidth = 2;
  ctx.setLineDash([5, 5]);
  
  ctx.beginPath();
  ctx.moveTo(0, center);
  ctx.lineTo(canvas.width, center);
  ctx.stroke();
  
  ctx.beginPath();
  ctx.moveTo(center, 0);
  ctx.lineTo(center, canvas.height);
  ctx.stroke();
  
  ctx.setLineDash([]);
  
  ctx.fillStyle = axisColor;
  ctx.font = "12px 'IBM Plex Mono', monospace";
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  
  for(let i = -gridSize; i <= gridSize; i++) {
    if(i === 0) continue;
    ctx.fillText(i, center + i*scale, center + 20);
    ctx.fillText(i, center - 20, center - i*scale);
  }
}

function drawDeterminantVisualization(M) {
  // Draw parallelogram formed by basis vectors
  const e1 = transform(M, [1, 0]);
  const e2 = transform(M, [0, 1]);
  
  ctx.fillStyle = 'rgba(251, 146, 60, 0.2)';
  ctx.strokeStyle = 'rgba(251, 146, 60, 0.6)';
  ctx.lineWidth = 2;
  
  ctx.beginPath();
  ctx.moveTo(center, center);
  ctx.lineTo(center + e1[0]*scale, center - e1[1]*scale);
  ctx.lineTo(center + (e1[0] + e2[0])*scale, center - (e1[1] + e2[1])*scale);
  ctx.lineTo(center + e2[0]*scale, center - e2[1]*scale);
  ctx.closePath();
  ctx.fill();
  ctx.stroke();
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const A = [
    [+a11.value, +a12.value],
    [+a21.value, +a22.value]
  ];

  const M = [
    [1 + t*(A[0][0]-1), t*A[0][1]],
    [t*A[1][0], 1 + t*(A[1][1]-1)]
  ];

  if(showAxes.checked) drawAxes();
  
  // Draw determinant visualization if enabled
  if(showDeterminant.checked) {
    drawDeterminantVisualization(M);
  }
  
  drawGrid(M);

  // Basis vectors
  const e1 = transform(M, [1, 0]);
  const e2 = transform(M, [0, 1]);
  
  arrow(center, center, 
        center + e1[0]*scale, center - e1[1]*scale, 
        "#3b82f6", 3);
  arrow(center, center, 
        center + e2[0]*scale, center - e2[1]*scale, 
        "#10b981", 3);

  // Test vector - only if checkbox is checked
  if(showTestVector.checked) {
    const v = [+vx.value, +vy.value];
    const vImg = transform(M, v);

    arrow(center, center,
          center + vImg[0]*scale,
          center - vImg[1]*scale,
          "#0891b2", 4);

    vectorInfo.textContent = 
      `A(v) = (${vImg[0].toFixed(2)}, ${vImg[1].toFixed(2)})`;
  } else {
    vectorInfo.textContent = 'Testvektor ausgeblendet';
  }
  
  // Calculate and display determinant
  const det = A[0][0] * A[1][1] - A[0][1] * A[1][0];
  detInfo.textContent = `det(A) = ${det.toFixed(2)}`;
}

function loop() {
  if(!running) return;
  t = Math.min(t + 0.01, 1);
  scrubber.value = t * 100;
  tValue.textContent = Math.round(t * 100) + '%';
  draw();
  if(t < 1) {
    animationId = requestAnimationFrame(loop);
  } else {
    running = false;
    animationId = null;
  }
}

function startAnimation() {
  if(animationId) {
    cancelAnimationFrame(animationId);
  }
  running = false;
  t = 0;
  scrubber.value = 0;
  tValue.textContent = '0%';
  running = true;
  loop();
}

function pause() { 
  running = false;
  if(animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
}

function resetAll() {
  running = false;
  if(animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
  t = 0;
  scrubber.value = 0;
  tValue.textContent = '0%';
  a11.value = 1;
  a12.value = 0;
  a21.value = 0;
  a22.value = 1;
  vx.value = 2;
  vy.value = 1;
  draw();
}

// Initial setup
renderExamples();
draw();
</script>

</body>
</html>